<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Hongfang Sun" />

<meta name="date" content="2020-01-02" />

<title>Introduction to homework</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to homework</h1>
<h4 class="author">Hongfang Sun</h4>
<h4 class="date">2020-01-02</h4>



<div id="homework2019.09.20" class="section level2">
<h2>Homework(2019.09.20)</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example-1-text" class="section level3">
<h3>Example 1-Text</h3>
<p>The following is the density function of normal distribution.<br />
<span class="math display">\[
f(x)=\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right)
\]</span></p>
<p>It is well known that the quantiles <span class="math inline">\(q_{\alpha}\)</span> of a random variable X may be defined as the minimizers of a piecewise-linear loss function. Namely, <span class="math display">\[
q_{\alpha}(X)=\underset{x \in \mathbb{R}}{\operatorname{argmin}}\left\{\alpha E\left[(X-x)^{+}\right]+(1-\alpha) E\left[(X-x)^{-}\right]\right\}
\]</span> where we use the notaion <span class="math inline">\(x^{+} :=\max \{x, 0\}\)</span> and <span class="math inline">\(x^{-} :=\max \{-x, 0\}\)</span>.</p>
</div>
<div id="example-2-figure" class="section level3">
<h3>Example 2-Figure</h3>
<p>There is a three-dimensional grid diagram.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">x&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="dt">length=</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">y&lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb1-3" title="3">f&lt;-<span class="st"> </span><span class="cf">function</span>(x,y) x<span class="op">^</span><span class="dv">2</span><span class="op">+</span>y<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1-4" title="4">z&lt;-<span class="st"> </span><span class="kw">outer</span>(x,y,f)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">persp</span>(x,y,z,<span class="dt">theta=</span><span class="dv">30</span>,<span class="dt">phi=</span><span class="dv">20</span>,<span class="dt">expand=</span><span class="fl">0.8</span>,<span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3-figure-and-table" class="section level3">
<h3>Example 3-Figure and table</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb2-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb2-3" title="3">y &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">plot</span>(x, y)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">out &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">library</span>(pander)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">panderOptions</span>(<span class="st">&quot;digits&quot;</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">pander</span>(out)</a></code></pre></div>
<table style="width:89%;">
<caption>Fitting linear model: y ~ x</caption>
<colgroup>
<col width="25%"></col>
<col width="15%"></col>
<col width="18%"></col>
<col width="13%"></col>
<col width="16%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-0.09051</td>
<td align="center">0.1017</td>
<td align="center">-0.8897</td>
<td align="center">0.3758</td>
</tr>
<tr class="even">
<td align="center"><strong>x</strong></td>
<td align="center">3.167</td>
<td align="center">0.1202</td>
<td align="center">26.34</td>
<td align="center">2.991e-46</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="homework2019.09.29" class="section level2">
<h2>Homework(2019.09.29)</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.18 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="use-inverse-transformation-method" class="section level3">
<h3>3.4 Use inverse transformation method</h3>
<p>There is an algorithm-“rral” to generate random samples from a Rayleigh(??) distribution.And an example is when n=10,sigma=1,the results of random samples are as follows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">rrayl &lt;-<span class="st"> </span><span class="cf">function</span>(n,sigma) {</a>
<a class="sourceLine" id="cb4-2" title="2">u&lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb4-3" title="3">v &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma)<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">return</span>(v)</a>
<a class="sourceLine" id="cb4-5" title="5">}</a>
<a class="sourceLine" id="cb4-6" title="6">x&lt;-<span class="kw">rrayl</span>(<span class="dv">10</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw">print</span>(x)</a></code></pre></div>
<pre><code>##  [1] 0.5899782 0.5620794 1.7215208 0.2875296 1.4205528 0.6670216 1.7435187
##  [8] 1.2001540 1.0474696 0.7381362</code></pre>
<p>When sigma=1</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">x &lt;-<span class="st"> </span><span class="kw">rrayl</span>(<span class="dv">1000</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">sigma &lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">lines</span>(<span class="kw">density</span>(x),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb6-5" title="5">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">.04</span>)</a>
<a class="sourceLine" id="cb6-6" title="6">z &lt;-<span class="st"> </span>y<span class="op">/</span>((sigma)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw">lines</span>(y,z)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When sigma=4</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">x &lt;-<span class="st"> </span><span class="kw">rrayl</span>(<span class="dv">1000</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">sigma &lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">lines</span>(<span class="kw">density</span>(x),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb7-5" title="5">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb7-6" title="6">z &lt;-<span class="st"> </span>y<span class="op">/</span>((sigma)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="kw">lines</span>(y,z)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When sigma=10</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">x &lt;-<span class="st"> </span><span class="kw">rrayl</span>(<span class="dv">1000</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">sigma &lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">lines</span>(<span class="kw">density</span>(x),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb8-5" title="5">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="fl">.4</span>)</a>
<a class="sourceLine" id="cb8-6" title="6">z &lt;-<span class="st"> </span>y<span class="op">/</span>((sigma)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw">lines</span>(y,z)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When sigma=100</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">x &lt;-<span class="st"> </span><span class="kw">rrayl</span>(<span class="dv">1000</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">sigma &lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">lines</span>(<span class="kw">density</span>(x),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb9-5" title="5">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">400</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb9-6" title="6">z &lt;-<span class="st"> </span>y<span class="op">/</span>((sigma)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">lines</span>(y,z)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the above three examples(sigma=1,4,10,100),we can find when sigma=1,4,10,100,the black line is very close to the red line,that means the mode of generated samples is close to the theoretical mode.</p>
</div>
<div id="section" class="section level3">
<h3>3.11</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb10-2" title="2">X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb10-3" title="3">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-4" title="4">Z1&lt;-<span class="st"> </span><span class="fl">0.75</span><span class="op">*</span>x <span class="fl">+0.25</span><span class="op">*</span>y</a>
<a class="sourceLine" id="cb10-5" title="5">p1 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-6" title="6">Z2 &lt;-<span class="st"> </span>p1<span class="op">*</span>x<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p1)<span class="op">*</span>y</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="kw">hist</span>(Z1)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">hist</span>(Z2)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>AS shown above,“Histogram of Z1” is the histogram of the sample with density superimposed for p1=0.75.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb12-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb12-3" title="3">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-4" title="4">W1&lt;-<span class="st"> </span><span class="fl">0.2</span><span class="op">*</span>x <span class="fl">+0.8</span><span class="op">*</span>y</a>
<a class="sourceLine" id="cb12-5" title="5">W2&lt;-<span class="st"> </span><span class="fl">0.4</span><span class="op">*</span>x <span class="fl">+0.6</span><span class="op">*</span>y</a>
<a class="sourceLine" id="cb12-6" title="6">W3&lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>x <span class="fl">+0.5</span><span class="op">*</span>y</a>
<a class="sourceLine" id="cb12-7" title="7">W4&lt;-<span class="st"> </span><span class="fl">0.6</span><span class="op">*</span>x <span class="fl">+0.4</span><span class="op">*</span>y</a>
<a class="sourceLine" id="cb12-8" title="8">W5&lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">*</span>x <span class="fl">+0.2</span><span class="op">*</span>y</a>
<a class="sourceLine" id="cb12-9" title="9">W6&lt;-<span class="st"> </span><span class="fl">0.7</span><span class="op">*</span>x <span class="fl">+0.3</span><span class="op">*</span>y</a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw">hist</span>(W1)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">hist</span>(W2)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">hist</span>(W3)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">hist</span>(W4)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">hist</span>(W5)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">hist</span>(W6)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>AS shown above,when p1=0.2,0.4,0.5,0.6,0.7,0.8,the empirical distribution of mixture may not appeare to be bimodal. But there must be a p1 that can produce bimodal mixtures,and I guess the value of p1 is close to 0.6. Because after a large number of experiments,there is an occasional result of bimodal distribution when p1=0.6.</p>
</div>
<div id="section-1" class="section level3">
<h3>3.18</h3>
<p>There is a function-rWishart to generate a random sample from Wishart distribution.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">rWishart &lt;-<span class="st"> </span><span class="cf">function</span>(n,p,Sigma) {</a>
<a class="sourceLine" id="cb18-2" title="2">L &lt;-<span class="st"> </span><span class="kw">chol</span>(Sigma) <span class="co">#Choleski factorization of Sigma</span></a>
<a class="sourceLine" id="cb18-3" title="3">A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(p<span class="op">*</span>p), <span class="dt">nrow=</span>p, <span class="dt">ncol=</span>p) </a>
<a class="sourceLine" id="cb18-4" title="4">B &lt;-<span class="st"> </span>A</a>
<a class="sourceLine" id="cb18-5" title="5">B[<span class="kw">lower.tri</span>(A)]&lt;-<span class="dv">0</span> <span class="co"># B is the mataix of the upper trig elements in A.</span></a>
<a class="sourceLine" id="cb18-6" title="6">C &lt;-<span class="st"> </span>A<span class="op">-</span>B           <span class="co"># C is a lower triangular matrix with 0 diagonal elements.</span></a>
<a class="sourceLine" id="cb18-7" title="7">E &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span>p)    </a>
<a class="sourceLine" id="cb18-8" title="8"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>p) {</a>
<a class="sourceLine" id="cb18-9" title="9">E[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))} <span class="co"># E is a vector with E[i]~chisq(1,n-i+1)</span></a>
<a class="sourceLine" id="cb18-10" title="10">G &lt;-<span class="st">  </span>C<span class="op">+</span><span class="kw">diag</span>(E,<span class="dt">nrow=</span>p) </a>
<a class="sourceLine" id="cb18-11" title="11">X &lt;-<span class="st"> </span>L<span class="op">%*%</span>G<span class="op">%*%</span><span class="kw">t</span>(G)<span class="op">%*%</span><span class="kw">t</span>(L) <span class="co"># The Bartlett decomposition of a matrix X</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="kw">return</span>(X)</a>
<a class="sourceLine" id="cb18-13" title="13">}</a></code></pre></div>
<p>For example,when n=1000,p=2,Sigma=matrix(c(1,0.9,0.9,1),the results are as follows.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">Y &lt;-<span class="kw">rWishart</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">print</span>(Y)</a></code></pre></div>
<pre><code>##           [,1]     [,2]
## [1,] 13.084757 3.865297
## [2,]  3.865297 1.353732</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">print</span>(<span class="kw">cov</span>(Y))</a></code></pre></div>
<pre><code>##          [,1]     [,2]
## [1,] 42.49922 11.57764
## [2,] 11.57764  3.15398</code></pre>
</div>
</div>
<div id="homework2019.10.11" class="section level2">
<h2>Homework(2019.10.11)</h2>
</div>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[
\int_{0}^{\pi / 3} \sin t d t
\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-5.1" class="section level2">
<h2>Answer 5.1</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">n &lt;-<span class="st"> </span><span class="fl">1e4</span> </a>
<a class="sourceLine" id="cb23-3" title="3">t &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>(pi)<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb23-4" title="4">estimator &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(t)) <span class="op">*</span><span class="st"> </span>(pi)<span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb23-5" title="5">exact.value &lt;-<span class="st"> </span><span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>((pi)<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb23-6" title="6"><span class="kw">print</span>(estimator)</a></code></pre></div>
<pre><code>## [1] 0.5009124</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">print</span>(exact.value)</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<p>The estimator <span class="math inline">\(\hat{\theta}=0.5009124\)</span> and the exact value of the integral is <span class="math display">\[\theta=\int_{0}^{\frac{\pi}{3}} \sin t d t=-\left.\cos t\right|_{0} ^{\frac{\pi}{3}}=\cos (0)-\cos \left(\frac{\pi}{3}\right)=0.5\]</span>. So,we can find the estimator is accurate.</p>
</div>
<div id="question-5.10" class="section level2">
<h2>Question 5.10</h2>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[
\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x
\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
</div>
<div id="answer-5.10" class="section level2">
<h2>Answer 5.10</h2>
<p>There is a function-“MC.Anti” to use Monte Carlo integration with antithetic variables.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">MC.Anti &lt;-<span class="st"> </span><span class="cf">function</span>(x,<span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb27-2" title="2">u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-3" title="3"><span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span></a>
<a class="sourceLine" id="cb27-4" title="4">v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb27-5" title="5">u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</a>
<a class="sourceLine" id="cb27-6" title="6">g &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-7" title="7">cdf&lt;-<span class="st"> </span><span class="kw">mean</span>(g)<span class="op">*</span>x</a>
<a class="sourceLine" id="cb27-8" title="8">cdf</a>
<a class="sourceLine" id="cb27-9" title="9">}</a>
<a class="sourceLine" id="cb27-10" title="10">x &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb27-12" title="12">MC1&lt;-<span class="kw">MC.Anti</span>(x,<span class="dt">antithetic =</span> <span class="ot">FALSE</span>) <span class="co"># generate a simple estimator </span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb27-14" title="14">MC2&lt;-<span class="kw">MC.Anti</span>(x) <span class="co"># generate an antithetic variable estimator</span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="kw">print</span>(<span class="kw">c</span>(MC1,MC2))</a></code></pre></div>
<pre><code>## [1] 0.5237823 0.5244769</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb29-2" title="2">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb29-3" title="3">MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb29-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb29-5" title="5">MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Anti</span>(<span class="dv">1</span>,<span class="dt">R=</span><span class="dv">1000</span>,<span class="dt">antithetic=</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb29-6" title="6">MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Anti</span>(<span class="dv">1</span>,<span class="dt">R=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb29-7" title="7">}</a>
<a class="sourceLine" id="cb29-8" title="8"><span class="kw">print</span>((<span class="kw">var</span>(MC1) <span class="op">-</span><span class="st"> </span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1)) <span class="co">#compute the approximate reduction in variance                                         as a percentage of the variance</span></a></code></pre></div>
<pre><code>## [1] 0.9629988</code></pre>
<p>AS shown above,the simple estimator MC1 is 0.5237823,the antithetic variable estimator MC2 is 0.5244769. And the approximate reduction in variance as a percentage of the variance is 0.9629988.</p>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-5.15" class="section level2">
<h2>Answer 5.15</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb31-2" title="2">M &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb31-3" title="3">k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#number of strata</span></a>
<a class="sourceLine" id="cb31-4" title="4">r &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k <span class="co">#replicates per stratum</span></a>
<a class="sourceLine" id="cb31-5" title="5">N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></a>
<a class="sourceLine" id="cb31-6" title="6">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb31-7" title="7">estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb31-8" title="8">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb31-9" title="9"><span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-10" title="10">}</a>
<a class="sourceLine" id="cb31-11" title="11">u &lt;-<span class="st"> </span><span class="kw">runif</span>(M) <span class="co">#f3, inverse transform method</span></a>
<a class="sourceLine" id="cb31-12" title="12">x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span> ( (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>u)</a>
<a class="sourceLine" id="cb31-13" title="13">h &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))}</a>
<a class="sourceLine" id="cb31-14" title="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb31-15" title="15">estimates[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M)))</a>
<a class="sourceLine" id="cb31-16" title="16"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb31-17" title="17">T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">h</span>(<span class="kw">runif</span>(M<span class="op">/</span>k, (j<span class="dv">-1</span>)<span class="op">/</span>k, j<span class="op">/</span>k)))</a>
<a class="sourceLine" id="cb31-18" title="18">estimates[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</a>
<a class="sourceLine" id="cb31-19" title="19">}</a>
<a class="sourceLine" id="cb31-20" title="20"><span class="kw">apply</span>(estimates,<span class="dv">2</span>,mean)</a></code></pre></div>
<pre><code>## [1] 0.5246928 0.4964716</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">apply</span>(estimates,<span class="dv">2</span>,var)</a></code></pre></div>
<pre><code>## [1] 5.592680e-06 3.920067e-08</code></pre>
<p>In Example 5.10 our best result was obtained with importance function <span class="math inline">\(f_{3}(x)=e^{-x} /\left(1-e^{-1}\right), \quad 0&lt;x&lt;1\)</span>.So by using inverse transform method,<span class="math inline">\(x=-\ln \left[\left(1-e^{-1}) y\right]\right.\)</span>. Now divide the interval (0,1) into five subintervals,and at he same time,use f3 as the importance function. The resutl of the estimator is 0.4964716,and compare with the result of Example 5.10,it is smaller.And the variance reduces a lot.Reason for this situation is using stratified sampling.</p>
</div>
<div id="homework2019.10.18" class="section level2">
<h2>Homework(2019.10.18)</h2>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6.5" class="section level2">
<h2>Answer 6.5</h2>
<p>If X1,…Xn is a random sample from a Normal<span class="math inline">\(\left(\mu, \sigma^{2}\right)\)</span>,n&gt;=2,then <span class="math display">\[
T=\frac{\bar{x}-\mu}{S / \sqrt{n}} \sim t(n-1)
\]</span></p>
<p>A 95% symmetric t-interval is given by <span class="math display">\[
\bar{x} \pm t_{1-a / 2}(n-1) s / \sqrt{n}
\]</span> But this question, we use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20.And we all know that <span class="math display">\[
X\sim \chi^{2}(2), \quad E(X)=2.
\]</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb35-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co"># simple size</span></a>
<a class="sourceLine" id="cb35-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb35-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> </a>
<a class="sourceLine" id="cb35-5" title="5">sum &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># count as required</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>m){</a>
<a class="sourceLine" id="cb35-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-8" title="8">LCL &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n) </a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co"># generate the lower bound of the confidence interval</span></a>
<a class="sourceLine" id="cb35-10" title="10">UCL &lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n) </a>
<a class="sourceLine" id="cb35-11" title="11"><span class="co"># generate the upper bound of the confidence interval</span></a>
<a class="sourceLine" id="cb35-12" title="12"><span class="cf">if</span>(LCL<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span>UCL<span class="op">&gt;</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-13" title="13">  sum &lt;-<span class="st"> </span>sum<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb35-14" title="14"><span class="cf">else</span></a>
<a class="sourceLine" id="cb35-15" title="15">  sum &lt;-<span class="st"> </span>sum<span class="op">+</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb35-16" title="16">} </a>
<a class="sourceLine" id="cb35-17" title="17"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(LCL),<span class="kw">mean</span>(UCL))) <span class="co"># the confidence interval</span></a></code></pre></div>
<pre><code>## [1] 1.031054 2.589626</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">print</span>(sum) <span class="co">#count the number of intervals that contain mu=2</span></a></code></pre></div>
<pre><code>## [1] 9218</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">print</span>(sum<span class="op">/</span>m) <span class="co"># compute the mean to get the confidence level</span></a></code></pre></div>
<pre><code>## [1] 0.9218</code></pre>
<p>AS shown above,the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data is 92.18%,the value is close to 95%.</p>
<p>And compare to Example 6.4,the result of t-interval is more robust,because when I try to run the code several times(no set.seed),the confidence interval only changed little,such as[1.031054 , 2.589626 ],[0.9714622 , 2.7817916],[0.9719535 , 2.2918802].</p>
</div>
<div id="question-6.6" class="section level2">
<h2>Question 6.6</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span>.</p>
</div>
<div id="answer-6.6" class="section level2">
<h2>Answer 6.6</h2>
<div id="part-1" class="section level3">
<h3>part 1</h3>
<p>When X1,…Xn is a random sample from a N(0,1),the following is the process to estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb41-2" title="2">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># generate the number of cycles</span></a>
<a class="sourceLine" id="cb41-3" title="3">b &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb41-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb41-5" title="5">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb41-6" title="6">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb41-7" title="7"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb41-8" title="8">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb41-9" title="9">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb41-10" title="10">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb41-11" title="11"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb41-12" title="12">}</a>
<a class="sourceLine" id="cb41-13" title="13">b[i] &lt;-<span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb41-14" title="14">}</a>
<a class="sourceLine" id="cb41-15" title="15"><span class="kw">quantile</span>(b,<span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>)) <span class="co"># compute the quantiles of the skewness</span></a></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1499353 -0.1277946  0.1204858  0.1544291</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">q &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>)</a>
<a class="sourceLine" id="cb43-2" title="2">Q &lt;-<span class="st"> </span><span class="kw">unname</span>(<span class="kw">quantile</span>(b,<span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>))) <span class="co"># just take the result below the percent</span></a>
<a class="sourceLine" id="cb43-3" title="3">f &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">6</span><span class="op">/</span>m)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)} </a>
<a class="sourceLine" id="cb43-4" title="4"><span class="co"># the density function of normal distribution</span></a>
<a class="sourceLine" id="cb43-5" title="5">Var &lt;-<span class="st"> </span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>m<span class="op">/</span>(<span class="kw">f</span>(Q))<span class="op">^</span><span class="dv">2</span> <span class="co"># according to the formula(2.14)</span></a>
<a class="sourceLine" id="cb43-6" title="6">se  &lt;-<span class="st"> </span><span class="kw">sqrt</span>(Var<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb43-7" title="7"><span class="kw">print</span>(<span class="kw">cbind</span>(q,se))</a></code></pre></div>
<pre><code>##          q           se
## [1,] 0.025 3.065628e-05
## [2,] 0.050 4.266372e-05
## [3,] 0.950 4.262503e-05
## [4,] 0.975 3.067725e-05</code></pre>
<p>From (2.14), <span class="math display">\[
\operatorname{Var}\left(\hat{x}_{q}\right)=\frac{q(1-q)}{n f\left(x_{q}\right)^{2}}
\]</span></p>
<p>AS shown above,we can see each of the standard error of the estimates when using the normal approximation.</p>
</div>
<div id="part-2" class="section level3">
<h3>part 2</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb45-2" title="2">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>),<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb45-3" title="3"><span class="kw">print</span>(cv)</a></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
<p>Compart the result of part1 with the quantiles of the large sample approximation,the two results are very close. It means that the Monte Carlo experiment is very useful.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb47-2" title="2">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb47-3" title="3">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb47-4" title="4">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb47-5" title="5">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb47-6" title="6"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb47-7" title="7">}</a>
<a class="sourceLine" id="cb47-8" title="8">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</a>
<a class="sourceLine" id="cb47-9" title="9">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb47-10" title="10">power &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb47-11" title="11">m&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb47-12" title="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb47-13" title="13">sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb47-14" title="14"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb47-15" title="15">  alpha &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb47-16" title="16"> x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n[i],alpha,alpha) <span class="co">#generate random numbers from Beta distribution</span></a>
<a class="sourceLine" id="cb47-17" title="17"> sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv[i]) <span class="co">#test decision is 1 (reject) or 0</span></a>
<a class="sourceLine" id="cb47-18" title="18">}</a>
<a class="sourceLine" id="cb47-19" title="19">power[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejicted</span></a>
<a class="sourceLine" id="cb47-20" title="20">}</a>
<a class="sourceLine" id="cb47-21" title="21"><span class="kw">print</span>(<span class="kw">rbind</span>(n,power))</a></code></pre></div>
<pre><code>##         [,1]   [,2]   [,3]   [,4]    [,5]    [,6]
## n     10.000 20.000 30.000 50.000 100.000 500.000
## power  0.056  0.046  0.045  0.053   0.041   0.046</code></pre>
</div>
</div>
<div id="homework2019.11.01" class="section level2">
<h2>Homework(2019.11.01)</h2>
</div>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(??, ??) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(??)?</p>
</div>
<div id="answer-6.7" class="section level2">
<h2>Answer 6.7</h2>
<div id="part-1-1" class="section level3">
<h3>part 1</h3>
<p>In this question,we all know Beta(??, ??) distributions is symmetric.The hypotheses are <span class="math display">\[
H_{0}: \sqrt{\beta_{1}}=0 ; \quad H_{1}: \sqrt{\beta_{1}} \neq 0
\]</span></p>
<p>Simliar to Example 6.10,we estimate by simulation the power of the skewness test of normality against a contaminated Beta (Beta scale mixture) alternative. The contaminated Beta distribution is denoted by</p>
<p><span class="math display">\[
(1-\varepsilon) \text { Beta }(\alpha=10, \alpha=10)+\varepsilon \text { Beta }(\alpha=500, \alpha=500), \quad 0 \leq \varepsilon \leq 1
\]</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb49-2" title="2">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb49-3" title="3">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb49-4" title="4">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb49-5" title="5"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb49-6" title="6">}</a>
<a class="sourceLine" id="cb49-7" title="7"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb49-8" title="8">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb49-9" title="9">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb49-10" title="10">m &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb49-11" title="11">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb49-12" title="12">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb49-13" title="13">power &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb49-14" title="14"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb49-15" title="15">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb49-16" title="16"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb49-17" title="17">e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb49-18" title="18">sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb49-19" title="19"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb49-20" title="20">a&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">500</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb49-21" title="21"><span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb49-22" title="22">x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a,a)</a>
<a class="sourceLine" id="cb49-23" title="23">sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb49-24" title="24">}</a>
<a class="sourceLine" id="cb49-25" title="25">power[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb49-26" title="26">}</a>
<a class="sourceLine" id="cb49-27" title="27"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb49-28" title="28"><span class="kw">plot</span>(epsilon, power, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb49-29" title="29"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;Power of Beta distribution&quot;</span>)</a>
<a class="sourceLine" id="cb49-30" title="30"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As shown above,we can find the curve shows a trend of first increasing and then decreasing. The power curve crosses the horizontal line corresponding to &lt; 0.10 and close to 0 at both endpoints, ?? = 0 and ?? = 1 where the alternative is normally distributed. For 0 &lt; ?? &lt; 1 the empirical power of the test is greater than 0.10 and highest when ?? is about 0.15.</p>
</div>
<div id="part-2-1" class="section level3">
<h3>part 2</h3>
<p>Simliar to Example 6.10,we estimate by simulation the power of the skewness test of normality against a contaminated t (t df mixture) alternative. The contaminated t distribution is denoted by <span class="math display">\[
(1-\varepsilon) t(n=1)+\varepsilon t(n=10), \quad 0 \leq \varepsilon \leq 1
\]</span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb50-2" title="2">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb50-3" title="3">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb50-4" title="4">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb50-5" title="5"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb50-6" title="6">}</a>
<a class="sourceLine" id="cb50-7" title="7"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb50-8" title="8">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb50-9" title="9">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb50-10" title="10">m &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb50-11" title="11">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb50-12" title="12">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb50-13" title="13">power &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb50-14" title="14"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb50-15" title="15">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb50-16" title="16"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb50-17" title="17">e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb50-18" title="18">sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb50-19" title="19"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb50-20" title="20">a&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb50-21" title="21"><span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb50-22" title="22">x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,a)</a>
<a class="sourceLine" id="cb50-23" title="23">sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb50-24" title="24">}</a>
<a class="sourceLine" id="cb50-25" title="25">power[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb50-26" title="26">}</a>
<a class="sourceLine" id="cb50-27" title="27"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb50-28" title="28"><span class="kw">plot</span>(epsilon, power, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb50-29" title="29"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;Power of t distribution&quot;</span>)</a>
<a class="sourceLine" id="cb50-30" title="30"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Compare the result of power with Part1,we can find the power curve is different, the curve shows a decreasing trend. When ?? = 0,the corrseponding value of power is &gt;0.8,When ?? = 1??the corrseponding value of power is close to 0.1.</p>
</div>
</div>
<div id="question-6.a" class="section level2">
<h2>Question 6.A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level ??, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) ??2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_{0}: \mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{1}: \mu \neq \mu_{0}\)</span>, where ??0 is the mean of ??2(1), Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-6.a" class="section level2">
<h2>Answer 6.A</h2>
<ol style="list-style-type: decimal">
<li>When the sampled population is ??2(1)</li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb51-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb51-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb51-4" title="4">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb51-5" title="5">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb51-6" title="6">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb51-7" title="7"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb51-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,mu0)</a>
<a class="sourceLine" id="cb51-9" title="9">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,<span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb51-10" title="10">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb51-11" title="11">}</a>
<a class="sourceLine" id="cb51-12" title="12">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p<span class="op">&lt;=</span>alpha)</a>
<a class="sourceLine" id="cb51-13" title="13">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb51-14" title="14"><span class="kw">print</span>(<span class="kw">c</span>(p.hat,se.hat))</a></code></pre></div>
<pre><code>## [1] 0.029500000 0.001692033</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>When the sampled population is Uniform(0,2)</li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb53-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb53-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb53-4" title="4">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb53-5" title="5">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb53-6" title="6">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb53-7" title="7"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb53-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>mu0)</a>
<a class="sourceLine" id="cb53-9" title="9">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,<span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb53-10" title="10">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb53-11" title="11">}</a>
<a class="sourceLine" id="cb53-12" title="12">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p<span class="op">&lt;=</span>alpha)</a>
<a class="sourceLine" id="cb53-13" title="13">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb53-14" title="14"><span class="kw">print</span>(<span class="kw">c</span>(p.hat,se.hat))</a></code></pre></div>
<pre><code>## [1] 0.047000000 0.002116388</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>When the sampled population is Exponential(rate=1)</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb55-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb55-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb55-4" title="4">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb55-5" title="5">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb55-6" title="6">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb55-7" title="7"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb55-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,mu0)</a>
<a class="sourceLine" id="cb55-9" title="9">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,<span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb55-10" title="10">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb55-11" title="11">}</a>
<a class="sourceLine" id="cb55-12" title="12">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p<span class="op">&lt;=</span>alpha)</a>
<a class="sourceLine" id="cb55-13" title="13">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb55-14" title="14"><span class="kw">print</span>(<span class="kw">c</span>(p.hat,se.hat))</a></code></pre></div>
<pre><code>## [1] 0.031800000 0.001754673</code></pre>
<p>AS shown above,when the sampled population is (i) ??2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1),the empirical Type I error rate of the t-test is approximately is not close to the nominal significance level ??(0.05),especially when (i) ??2(1) and (iii) Exponential(rate=1).</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ol style="list-style-type: decimal">
<li>What is the corresponding hypothesis test problem?</li>
<li>What test should we use? Z-test, two-sample t-test, paired-ttest or McNemar test?</li>
<li>What information is needed to test your hypothesis?</li>
</ol>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="part-1-2" class="section level3">
<h3>Part 1</h3>
<p>Supposed the power for one method is P1,the power for another method is P2,?? at 0.05 level,the corrseponding hypothesis test problem is <span class="math display">\[
H_{0}: P_{1}=P_{2} \quad \text { vs } \quad H_{1}: P_{1} \neq P_{2}
\]</span></p>
</div>
<div id="part-2-2" class="section level3">
<h3>Part 2</h3>
<p>I think the McNemar test is appropriate and useful. McNemar??s Test is a matched pair test for 2 * 2 tables, it is often used to compare two proportions estimated from paired observations.For example,if you want to see if two doctors obtain comparable results,when checking (the same) patients, you would use this test.</p>
</div>
<div id="part-3" class="section level3">
<h3>Part 3</h3>
<p>We should prepare some examples,for each example, we use two methods to calculate it’s power. So, the sample size n should be known. In order to calculate the power,the confidence level should be given,such as 0.05. Most important of all,we should set a standard.That means we should determine a constant <span class="math inline">\(\varepsilon\)</span>, such that <span class="math display">\[
\left|P_{i 1}-P_{i 2}\right| \leqslant \varepsilon \quad \forall i=1.2 \cdots n
\]</span> Then we can think P1 and P2 are same,else are different.</p>
</div>
</div>
<div id="homework2019.11.08" class="section level2">
<h2>Homework(2019.11.08)</h2>
</div>
<div id="question-7.6" class="section level2">
<h2>Question 7.6</h2>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores (xi1, . . . , xi5) for the ith student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: ????12 = ????(mec, vec), ????34 = ????(alg, ana), ????35 = ????(alg, sta), ????45 = ????(ana, sta).</p>
</div>
<div id="answer-7.6" class="section level2">
<h2>Answer 7.6</h2>
<div id="part-1-3" class="section level3">
<h3>Part 1</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">data</span>(scor,<span class="dt">package=</span><span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb57-3" title="3"><span class="kw">pairs</span>(<span class="op">~</span>.,<span class="dt">data=</span>scor,<span class="dt">main=</span><span class="st">&quot;Scatterplot Matrix&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">cor</span>(scor)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<p>As shown above,we can see the scatter plots for each pair of test scores in the “Scatterplot Matrix”,and can get the sample correlation matrix.Compare the plot with the sample correlation matrix,we can find the correlation reflects the slope in the scatterplot to some extent.</p>
</div>
<div id="part-2-3" class="section level3">
<h3>Part 2</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb60-3" title="3">B &lt;-<span class="st"> </span><span class="dv">200</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb60-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor) <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb60-5" title="5">R12 &lt;-<span class="st"> </span>R34 &lt;-<span class="st"> </span>R35 &lt;-<span class="st"> </span>R45 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb60-6" title="6"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb60-7" title="7"><span class="co">#randomly select the indices</span></a>
<a class="sourceLine" id="cb60-8" title="8">i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb60-9" title="9">mec &lt;-<span class="st"> </span>scor<span class="op">$</span>mec[i] <span class="co">#i is a vector of indices</span></a>
<a class="sourceLine" id="cb60-10" title="10">vec &lt;-<span class="st"> </span>scor<span class="op">$</span>vec[i]</a>
<a class="sourceLine" id="cb60-11" title="11">alg &lt;-<span class="st"> </span>scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb60-12" title="12">ana &lt;-<span class="st"> </span>scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb60-13" title="13">sta &lt;-<span class="st"> </span>scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb60-14" title="14">R12[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(mec,vec)</a>
<a class="sourceLine" id="cb60-15" title="15">R34[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(alg,ana)</a>
<a class="sourceLine" id="cb60-16" title="16">R35[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(alg,sta)</a>
<a class="sourceLine" id="cb60-17" title="17">R45[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(ana,sta)</a>
<a class="sourceLine" id="cb60-18" title="18">}</a>
<a class="sourceLine" id="cb60-19" title="19"><span class="co">#output</span></a>
<a class="sourceLine" id="cb60-20" title="20"><span class="kw">cat</span>(<span class="st">&#39;SE.R12 =&#39;</span>,<span class="kw">sd</span>(R12),</a>
<a class="sourceLine" id="cb60-21" title="21">    <span class="st">&#39;SE.R34 =&#39;</span>,<span class="kw">sd</span>(R34),</a>
<a class="sourceLine" id="cb60-22" title="22">    <span class="st">&#39;SE.R35 =&#39;</span>,<span class="kw">sd</span>(R35),</a>
<a class="sourceLine" id="cb60-23" title="23">    <span class="st">&#39;SE.R45 =&#39;</span>,<span class="kw">sd</span>(R45))</a></code></pre></div>
<pre><code>## SE.R12 = 0.0755044 SE.R34 = 0.05219754 SE.R35 = 0.06181367 SE.R45 = 0.06986401</code></pre>
<p>As shown above,we can see the bootstrap estimates of the standard errors(SE.R12,SE.R34,SE.R35,SE.R45) for each of the estimates.</p>
</div>
</div>
<div id="question-7.b" class="section level2">
<h2>Question 7.B</h2>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and ??2(5) distributions (positive skewness).</p>
</div>
<div id="answer-7.b" class="section level2">
<h2>Answer 7.B</h2>
<div id="part-1-normal-distribution" class="section level3">
<h3>Part 1 Normal distribution</h3>
<p>The output for the bootstrap confidence intervals is below.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb62-3" title="3">sk &lt;-<span class="st"> </span><span class="cf">function</span>(data,indices){</a>
<a class="sourceLine" id="cb62-4" title="4">x &lt;-<span class="st"> </span>data[indices]</a>
<a class="sourceLine" id="cb62-5" title="5">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb62-6" title="6">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb62-7" title="7">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb62-8" title="8"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb62-9" title="9">}</a>
<a class="sourceLine" id="cb62-10" title="10">data &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb62-11" title="11">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(data,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb62-12" title="12"><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)))</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;))
## 
## Intervals : 
## Level      Normal              Basic              Percentile     
## 95%   (-0.3317,  0.4482 )   (-0.3376,  0.4492 )   (-0.3282,  0.4586 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>As we all known,the skewness of normal populations is equal to 0.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">mu &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># skewness of normal distribution</span></a>
<a class="sourceLine" id="cb64-2" title="2">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb64-3" title="3">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb64-5" title="5"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb64-6" title="6">boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){ <span class="co">#function to compute the skewness statistic</span></a>
<a class="sourceLine" id="cb64-7" title="7">  x &lt;-<span class="st"> </span>x[i]</a>
<a class="sourceLine" id="cb64-8" title="8">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb64-9" title="9">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb64-10" title="10">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb64-11" title="11">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb64-12" title="12">}</a>
<a class="sourceLine" id="cb64-13" title="13">ci.norm &lt;-<span class="st"> </span>ci.basic &lt;-<span class="st"> </span>ci.perc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb64-14" title="14"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb64-15" title="15">  U &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb64-16" title="16">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>U,<span class="dt">statistic=</span>boot.sk,<span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb64-17" title="17">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb64-18" title="18">ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb64-19" title="19">ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb64-20" title="20">}</a>
<a class="sourceLine" id="cb64-21" title="21">Pr.nrom &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu),</a>
<a class="sourceLine" id="cb64-22" title="22">             <span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu))</a>
<a class="sourceLine" id="cb64-23" title="23">Pr.basic &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu),</a>
<a class="sourceLine" id="cb64-24" title="24">             <span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu))</a>
<a class="sourceLine" id="cb64-25" title="25">Pr.perc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu),</a>
<a class="sourceLine" id="cb64-26" title="26">             <span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu))</a>
<a class="sourceLine" id="cb64-27" title="27"><span class="kw">data.frame</span>(Pr.nrom,Pr.basic,Pr.perc,<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;miss.left&quot;</span>,<span class="st">&quot;miss.right&quot;</span>))</a></code></pre></div>
<pre><code>##            Pr.nrom Pr.basic Pr.perc
## coverage     0.924    0.922   0.945
## miss.left    0.041    0.045   0.029
## miss.right   0.035    0.033   0.026</code></pre>
<p>As shown above,we can get the coverage probabilities of normal,basic,and percentile 95% confidence interval.Maybe the percentile confidence interval is more close to 0.95,the result of the basic bootstrap confidence interval is not good.</p>
</div>
<div id="part-2-chi-square-distribution" class="section level3">
<h3>Part 2 Chi-square distribution</h3>
<p>The output for the bootstrap confidence intervals is below.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb66-3" title="3">sk &lt;-<span class="st"> </span><span class="cf">function</span>(data,indices){</a>
<a class="sourceLine" id="cb66-4" title="4">x &lt;-<span class="st"> </span>data[indices]</a>
<a class="sourceLine" id="cb66-5" title="5">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb66-6" title="6">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb66-7" title="7">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb66-8" title="8"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb66-9" title="9">}</a>
<a class="sourceLine" id="cb66-10" title="10">data &lt;-<span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">100</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb66-11" title="11">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(data,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb66-12" title="12"><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)))</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;))
## 
## Intervals : 
## Level      Normal              Basic              Percentile     
## 95%   ( 0.5966,  1.3661 )   ( 0.5889,  1.3856 )   ( 0.5150,  1.3116 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>In order to get the true skewness of <span class="math inline">\(\chi^{2}(5)\)</span> distributions,I install the package-“moments” and use the function-“skewness()”.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">library</span>(moments)</a>
<a class="sourceLine" id="cb68-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb68-3" title="3">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">100</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb68-4" title="4">mu &lt;-<span class="st"> </span><span class="kw">skewness</span>(x) <span class="co"># skewness of ??2(5) distribution</span></a>
<a class="sourceLine" id="cb68-5" title="5"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb68-6" title="6">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb68-7" title="7">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb68-8" title="8">boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb68-9" title="9">  x &lt;-<span class="st"> </span>x[i]</a>
<a class="sourceLine" id="cb68-10" title="10">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb68-11" title="11">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb68-12" title="12">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb68-13" title="13"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb68-14" title="14">}</a>
<a class="sourceLine" id="cb68-15" title="15">ci.norm &lt;-<span class="st"> </span>ci.basic &lt;-<span class="st"> </span>ci.perc &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb68-16" title="16"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb68-17" title="17">  U &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb68-18" title="18">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>U,<span class="dt">statistic=</span>boot.sk,<span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb68-19" title="19">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb68-20" title="20">ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb68-21" title="21">ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb68-22" title="22">}</a>
<a class="sourceLine" id="cb68-23" title="23">Pr.nrom &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu),</a>
<a class="sourceLine" id="cb68-24" title="24">             <span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu))</a>
<a class="sourceLine" id="cb68-25" title="25">Pr.basic &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu),</a>
<a class="sourceLine" id="cb68-26" title="26">             <span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu))</a>
<a class="sourceLine" id="cb68-27" title="27">Pr.perc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu),</a>
<a class="sourceLine" id="cb68-28" title="28">             <span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu))</a>
<a class="sourceLine" id="cb68-29" title="29"><span class="kw">data.frame</span>(Pr.nrom,Pr.basic,Pr.perc,<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;miss.left&quot;</span>,<span class="st">&quot;miss.right&quot;</span>))</a></code></pre></div>
<pre><code>##            Pr.nrom Pr.basic Pr.perc
## coverage     0.823    0.773   0.929
## miss.left    0.143    0.190   0.028
## miss.right   0.034    0.037   0.043</code></pre>
<p>Compare the result of Part 1,the results of the coverage probabilities of these 3 confidence intervals are not good,especially the basic,and standard normal bootstrap confidence interval,equal to 0.773,0823 respectively. In conclusion,the percentile confidence interval is more robust.</p>
</div>
</div>
<div id="homework2019.11.15" class="section level2">
<h2>Homework(2019.11.15)</h2>
</div>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of ????.</p>
</div>
<div id="answer-7.8" class="section level2">
<h2>Answer 7.8</h2>
<p>The function-“First.pc” can be used to compute the estimate of the proportion of variance explained by the first principal component <span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_{1}}{\sum_{j=1}^{5} \hat{\lambda}_{j}}
\]</span></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">First.pc &lt;-<span class="st"> </span><span class="cf">function</span>(data){</a>
<a class="sourceLine" id="cb70-2" title="2">  m &lt;-<span class="st"> </span><span class="kw">nrow</span>(data)</a>
<a class="sourceLine" id="cb70-3" title="3">  cov.MLE &lt;-<span class="st"> </span><span class="kw">cov</span>(data)<span class="op">*</span>(m<span class="dv">-1</span>)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb70-4" title="4">  evals &lt;-<span class="st"> </span><span class="kw">eigen</span>(cov.MLE)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb70-5" title="5">  First.pc &lt;-<span class="st"> </span>evals[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(evals[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb70-6" title="6">  <span class="kw">return</span>(First.pc)</a>
<a class="sourceLine" id="cb70-7" title="7">}</a>
<a class="sourceLine" id="cb70-8" title="8"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb70-9" title="9"><span class="kw">data</span>(scor,<span class="dt">package=</span><span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb70-10" title="10">theta.hat &lt;-<span class="st"> </span><span class="kw">First.pc</span>(scor)</a>
<a class="sourceLine" id="cb70-11" title="11">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb70-12" title="12">theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb70-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb70-14" title="14">  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">First.pc</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb70-15" title="15">}</a>
<a class="sourceLine" id="cb70-16" title="16">bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</a>
<a class="sourceLine" id="cb70-17" title="17">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb70-18" title="18"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,bias,se))</a></code></pre></div>
<pre><code>## [1] 0.619115038 0.001069139 0.049552307</code></pre>
<p>As shown above,theta.hat=0.619115,bias=0.001069139,se=0.04955231</p>
</div>
<div id="exercise-7.10" class="section level2">
<h2>Exercise 7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted R2?</p>
</div>
<div id="answer-7.10" class="section level2">
<h2>Answer 7.10</h2>
<p>Four models: L1,L2,L3,L4. <span class="math display">\[
\begin{array}{l}{\text { 1. Linear: } Y=\beta_{0}+\beta_{1} X+\varepsilon .} \\ {\text { 2. Quadratic: } Y=\beta_{0}+\beta_{1} X+\beta_{2} X^{2}+\varepsilon} \\ {\text { 3. Exponential: } \log (Y)=\log \left(\beta_{0}\right)+\beta_{1} X+\varepsilon} \\ {\text { 4. Cubic: } Y=\beta_{0}+\beta_{1} X+\beta_{2} X^{2}+\beta_{3} X^{3}+\varepsilon}\end{array}
\]</span></p>
<div id="part-1-4" class="section level3">
<h3>Part 1</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb76-2" title="2">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></a>
<a class="sourceLine" id="cb76-3" title="3">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb76-4" title="4"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb76-5" title="5">yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb76-6" title="6"><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb77-3" title="3">yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb77-4" title="4"><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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KXL6USYeN/pQO8P8TZ2qf2YmRzF2wtboejmqvU4/dxO3G/64Rg6nnYmi/iwH39xe2rDnS1tDxyBywJgDlx/DxOnGOOQ9Hb/oYhWIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKCmAPmfDmM9mueBMh49EKBcb4kTAQJqBNDAs+Wv5z+OImFlEKmrl+O/ztPGhe8VLAaZVy9TW54EkHg+6el6ZonP8h/LkboceUL96wdLoOMspCXPmxLbzwCI58Srv5fjm3g9vn7wRDL53xtjoS1/+y5y7J4DkEpS5bWd/hPpcir9Uv3HH9dtpLOO935XUG0AkkmqGpBciM0CSKWzTqHo9d9P3oJudzarFqQPPAegewwSgHStV4CUpUjof5ouxsejz/eDAsRf33r5cx8TkLIUjYf/VuMpAOl5kJrZsNdTI1kDUvMgntg7IXwWQO2KAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBA/wdkMV5gp4r1bgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb78-3" title="3">logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb78-4" title="4">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb78-5" title="5"><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb79-2" title="2"><span class="kw">plot</span>(chemical,magnetic, <span class="dt">main=</span><span class="st">&quot;Cubic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb79-3" title="3">yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span>a <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb79-4" title="4"><span class="kw">lines</span>(a, yhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;A.Rs-L1 =&#39;</span>,<span class="kw">summary</span>(L1)<span class="op">$</span>adj.r.squared,</a>
<a class="sourceLine" id="cb80-2" title="2">    <span class="st">&#39;A.Rs-L2 =&#39;</span>,<span class="kw">summary</span>(L2)<span class="op">$</span>adj.r.squared,</a>
<a class="sourceLine" id="cb80-3" title="3">    <span class="st">&#39;A.Rs-L3 =&#39;</span>,<span class="kw">summary</span>(L3)<span class="op">$</span>adj.r.squared,</a>
<a class="sourceLine" id="cb80-4" title="4">    <span class="st">&#39;A.Rs-L4 =&#39;</span>,<span class="kw">summary</span>(L4)<span class="op">$</span>adj.r.squared)</a></code></pre></div>
<pre><code>## A.Rs-L1 = 0.5281545 A.Rs-L2 = 0.5768151 A.Rs-L3 = 0.5280556 A.Rs-L4 = 0.5740396</code></pre>
<p>As we all know,a model that includes several predictors will return higher R2 and adjusted R2 values and may seem to be a better fit. So,according to adjusted R-squarted, L2-the quadratic model is the best.</p>
</div>
<div id="part-2-4" class="section level3">
<h3>Part 2</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb82-2" title="2">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb82-5" title="5"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb82-6" title="6">y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb82-7" title="7">x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb82-8" title="8">J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb82-9" title="9">yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb82-10" title="10">e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb82-11" title="11">J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb82-12" title="12">yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb82-13" title="13">e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb82-14" title="14">J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb82-15" title="15">logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb82-16" title="16">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb82-17" title="17">e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb82-18" title="18">J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb82-19" title="19">yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb82-20" title="20">e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb82-21" title="21">}</a>
<a class="sourceLine" id="cb82-22" title="22"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;E-J1 =&#39;</span>,<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb84-2" title="2">    <span class="st">&#39;E-J2 =&#39;</span>,<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb84-3" title="3">    <span class="st">&#39;E-J3 =&#39;</span>,<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb84-4" title="4">    <span class="st">&#39;E-J4 =&#39;</span>,<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## E-J1 = 19.55644 E-J2 = 17.85248 E-J3 = 18.44188 E-J4 = 18.17756</code></pre>
<p>As shown above,the model-J2,the quadratic model, is selected by the cross validation procedure.</p>
</div>
</div>
<div id="homework2019.11.22" class="section level2">
<h2>Homework(2019.11.22)</h2>
</div>
<div id="exercise-8.3" class="section level2">
<h2>Exercise 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-8.3" class="section level2">
<h2>Answer 8.3</h2>
<p>Suppose that X = (X1, . . .,Xn) and Y = (Y1, . . . , Ym) are independent random samples from distributions F and G respectively, and we wish to test the hypothesis <span class="math display">\[
H_{0}: F=G \text { vs } H_{1}: F \neq G.
\]</span> And<span class="math inline">\(X \sim N(0,1), \quad Y \sim N(0,1)\)</span>,n1=20,n2=30,the sample size is unequal.Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<div id="part-1-recall-example-6.15" class="section level3">
<h3>Part 1 Recall Example 6.15</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb86-2" title="2">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb86-3" title="3">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb86-4" title="4">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb86-5" title="5">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb86-6" title="6"><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb86-7" title="7"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb86-8" title="8">}</a>
<a class="sourceLine" id="cb86-9" title="9">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb86-10" title="10">n2 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb86-11" title="11">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb86-12" title="12">sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb86-13" title="13">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb86-14" title="14">alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb86-15" title="15">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb86-16" title="16">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb86-17" title="17">x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></a>
<a class="sourceLine" id="cb86-18" title="18">y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb86-19" title="19"><span class="kw">count5test</span>(x, y)</a>
<a class="sourceLine" id="cb86-20" title="20">}))</a>
<a class="sourceLine" id="cb86-21" title="21"><span class="kw">print</span>(alphahat)</a></code></pre></div>
<pre><code>## [1] 0.1022</code></pre>
<p>The simulation result suggests that the Count 5 criterion is not applicable for unequal sample sizes.</p>
</div>
<div id="part-2-implement-a-permutation-test" class="section level3">
<h3>Part 2 Implement a permutation test</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb88-2" title="2">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb88-3" title="3">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb88-4" title="4">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb88-5" title="5">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb88-6" title="6"><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb88-7" title="7"><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb88-8" title="8">} <span class="co">#counts the maximum number of extreme points</span></a>
<a class="sourceLine" id="cb88-9" title="9"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb88-10" title="10">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb88-11" title="11">n2 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb88-12" title="12">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb88-13" title="13">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb88-14" title="14">R &lt;-<span class="st"> </span><span class="dv">999</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb88-15" title="15">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co">#pooled sample</span></a>
<a class="sourceLine" id="cb88-16" title="16">K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">50</span></a>
<a class="sourceLine" id="cb88-17" title="17">C &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb88-18" title="18"><span class="kw">options</span>(<span class="dt">warn =</span> <span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb88-19" title="19">C0 &lt;-<span class="st"> </span><span class="kw">maxout</span>(x, y)</a>
<a class="sourceLine" id="cb88-20" title="20"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb88-21" title="21"><span class="co">#generate indices k for the first sample</span></a>
<a class="sourceLine" id="cb88-22" title="22">k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb88-23" title="23">x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb88-24" title="24">y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></a>
<a class="sourceLine" id="cb88-25" title="25">C[i] &lt;-<span class="st"> </span><span class="kw">maxout</span>(x1, y1)</a>
<a class="sourceLine" id="cb88-26" title="26">}</a>
<a class="sourceLine" id="cb88-27" title="27">p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(C0, C) <span class="op">&gt;=</span><span class="st"> </span>C0)</a>
<a class="sourceLine" id="cb88-28" title="28"><span class="kw">options</span>(<span class="dt">warn =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb88-29" title="29"><span class="kw">print</span>(p)</a></code></pre></div>
<pre><code>## [1] 0.303</code></pre>
<p>The approximate ASL 0.303 does not support the alternative hypothesis that distributions differ.</p>
</div>
</div>
<div id="slides-p31" class="section level2">
<h2>Slides P31</h2>
<p>Power comparison (distance correlation test versus ball covariance test) Model 1: Y = X/4 + e Model 2: Y = X/4 ?? e X ~ N(02, I2), e ~ N(02, I2), X and e are independent.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="part-1-model-1" class="section level3">
<h3>Part 1 Model 1</h3>
<p><span class="math display">\[
\text { Model } 1: Y=X / 4+e
\]</span> <span class="math inline">\(X \sim N\left(0_{2}, I_{2}\right), e \sim N\left(0_{2}, I_{2}\right), X\)</span> and <span class="math inline">\(e\)</span> are independent.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb90-2" title="2">x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</a>
<a class="sourceLine" id="cb90-3" title="3">y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb90-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb90-5" title="5">m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb90-6" title="6"><span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb90-7" title="7"><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb90-8" title="8"><span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb90-9" title="9">Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb90-10" title="10">d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb90-11" title="11">m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d)</a>
<a class="sourceLine" id="cb90-12" title="12">M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb90-13" title="13">a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m)</a>
<a class="sourceLine" id="cb90-14" title="14">b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb90-15" title="15"><span class="kw">return</span>(b <span class="op">+</span><span class="st"> </span>M)</a>
<a class="sourceLine" id="cb90-16" title="16">}</a>
<a class="sourceLine" id="cb90-17" title="17">A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x)</a>
<a class="sourceLine" id="cb90-18" title="18">B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb90-19" title="19">dCov &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb90-20" title="20">dCov</a>
<a class="sourceLine" id="cb90-21" title="21">}</a>
<a class="sourceLine" id="cb90-22" title="22">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb90-23" title="23"><span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb90-24" title="24">p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb90-25" title="25">q1 &lt;-<span class="st"> </span>dims[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb90-26" title="26">d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb90-27" title="27">x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb90-28" title="28">y &lt;-<span class="st"> </span>z[ix, q1<span class="op">:</span>d] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb90-29" title="29"><span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-30" title="30">}</a>
<a class="sourceLine" id="cb90-31" title="31"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb90-32" title="32">m &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb90-33" title="33">p.value &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb90-34" title="34">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">150</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb90-35" title="35">N &lt;-<span class="st"> </span><span class="kw">length</span>(n)</a>
<a class="sourceLine" id="cb90-36" title="36">power1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb90-37" title="37"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb90-38" title="38">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb90-39" title="39">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n[i],<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-40" title="40">e &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n[i],<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-41" title="41">Y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>X<span class="op">+</span>e</a>
<a class="sourceLine" id="cb90-42" title="42">z &lt;-<span class="st"> </span><span class="kw">cbind</span>(X,Y)</a>
<a class="sourceLine" id="cb90-43" title="43">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">99</span>,</a>
<a class="sourceLine" id="cb90-44" title="44"><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb90-45" title="45">tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb90-46" title="46">p.value[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>boot.obj<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb90-47" title="47">  }</a>
<a class="sourceLine" id="cb90-48" title="48">power1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.value<span class="op">&lt;</span>.<span class="dv">05</span>)  </a>
<a class="sourceLine" id="cb90-49" title="49">}</a>
<a class="sourceLine" id="cb90-50" title="50"><span class="kw">plot</span>(n, power1, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">pch=</span><span class="dv">15</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;DarkTurquoise&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(n), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;Power Comparsion-Model 1&quot;</span>)</a>
<a class="sourceLine" id="cb90-51" title="51"></a>
<a class="sourceLine" id="cb90-52" title="52">m &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb90-53" title="53">p.ball &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb90-54" title="54">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">150</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb90-55" title="55">N &lt;-<span class="st"> </span><span class="kw">length</span>(n)</a>
<a class="sourceLine" id="cb90-56" title="56">power2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb90-57" title="57"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb90-58" title="58"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb90-59" title="59">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n[i],<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-60" title="60">e &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n[i],<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-61" title="61">Y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>X<span class="op">+</span>e</a>
<a class="sourceLine" id="cb90-62" title="62"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb90-63" title="63">p.ball[j] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(X,Y,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb90-64" title="64">}</a>
<a class="sourceLine" id="cb90-65" title="65">power2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.ball<span class="op">&lt;</span>.<span class="dv">05</span>)</a>
<a class="sourceLine" id="cb90-66" title="66">}</a>
<a class="sourceLine" id="cb90-67" title="67"><span class="kw">print</span>(<span class="kw">cbind</span>(n,power1,power2))</a></code></pre></div>
<pre><code>##         n power1 power2
##  [1,]  10    0.1    0.0
##  [2,]  20    0.1    0.0
##  [3,]  30    0.1    0.0
##  [4,]  40    0.1    0.0
##  [5,]  50    0.1    0.0
##  [6,]  60    0.5    0.0
##  [7,]  70    0.7    0.0
##  [8,]  80    0.8    0.0
##  [9,]  90    0.8    0.0
## [10,] 100    0.5    0.9
## [11,] 110    0.9    1.0
## [12,] 120    0.8    0.9
## [13,] 130    0.9    0.9
## [14,] 140    0.6    0.9
## [15,] 150    1.0    1.0</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">par</span>(<span class="dt">new=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">plot</span>(n, power2, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;DeepPink&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(n), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="kw">legend</span>(<span class="dv">120</span>,<span class="fl">0.3</span>,<span class="kw">c</span>(<span class="st">&quot;distance&quot;</span>,<span class="st">&quot;ball&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;DarkTurquoise&quot;</span>,<span class="st">&quot;DeepPink&quot;</span>),<span class="dt">text.col=</span><span class="kw">c</span>(<span class="st">&quot;DarkTurquoise&quot;</span>,<span class="st">&quot;DeepPink&quot;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">16</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The blue line is for power1~n(distance covariance test),the pink line is for power2~n(ball covariance test).As shown above, we can see empirical power comparison of the distance covariance test dCov and ball covariance test for model 1.</p>
</div>
<div id="part-2-model-2" class="section level3">
<h3>Part 2 Model 2</h3>
<p><span class="math display">\[
\text { Model } 2: Y=X / 4 \times e
\]</span> <span class="math inline">\(X \sim N\left(0_{2}, I_{2}\right), e \sim N\left(0_{2}, I_{2}\right), X\)</span> and <span class="math inline">\(e\)</span> are independent.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb93-2" title="2">x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</a>
<a class="sourceLine" id="cb93-3" title="3">y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb93-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb93-5" title="5">m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb93-6" title="6"><span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb93-7" title="7"><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb93-8" title="8"><span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb93-9" title="9">Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb93-10" title="10">d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb93-11" title="11">m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d)</a>
<a class="sourceLine" id="cb93-12" title="12">M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb93-13" title="13">a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m)</a>
<a class="sourceLine" id="cb93-14" title="14">b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb93-15" title="15"><span class="kw">return</span>(b <span class="op">+</span><span class="st"> </span>M)</a>
<a class="sourceLine" id="cb93-16" title="16">}</a>
<a class="sourceLine" id="cb93-17" title="17">A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x)</a>
<a class="sourceLine" id="cb93-18" title="18">B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb93-19" title="19">dCov &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb93-20" title="20">dCov</a>
<a class="sourceLine" id="cb93-21" title="21">}</a>
<a class="sourceLine" id="cb93-22" title="22">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb93-23" title="23"><span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb93-24" title="24">p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb93-25" title="25">q1 &lt;-<span class="st"> </span>dims[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb93-26" title="26">d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb93-27" title="27">x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb93-28" title="28">y &lt;-<span class="st"> </span>z[ix, q1<span class="op">:</span>d] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb93-29" title="29"><span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-30" title="30">}</a>
<a class="sourceLine" id="cb93-31" title="31"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb93-32" title="32">m &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb93-33" title="33">p.value &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb93-34" title="34">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">150</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb93-35" title="35">N &lt;-<span class="st"> </span><span class="kw">length</span>(n)</a>
<a class="sourceLine" id="cb93-36" title="36">power1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb93-37" title="37"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb93-38" title="38">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb93-39" title="39">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n[i],<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-40" title="40">e &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n[i],<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-41" title="41">Y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>X<span class="op">*</span>e</a>
<a class="sourceLine" id="cb93-42" title="42">z &lt;-<span class="st"> </span><span class="kw">cbind</span>(X,Y)</a>
<a class="sourceLine" id="cb93-43" title="43">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">99</span>,</a>
<a class="sourceLine" id="cb93-44" title="44"><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb93-45" title="45">tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb93-46" title="46">p.value[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>boot.obj<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb93-47" title="47">  }</a>
<a class="sourceLine" id="cb93-48" title="48">power1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.value<span class="op">&lt;</span>.<span class="dv">05</span>)  </a>
<a class="sourceLine" id="cb93-49" title="49">}</a>
<a class="sourceLine" id="cb93-50" title="50"><span class="kw">plot</span>(n, power1, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">pch=</span><span class="dv">15</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;DarkTurquoise&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(n), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&quot;Power Comparsion-Model 2&quot;</span>)</a>
<a class="sourceLine" id="cb93-51" title="51"></a>
<a class="sourceLine" id="cb93-52" title="52">m &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb93-53" title="53">p.ball &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb93-54" title="54">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">150</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb93-55" title="55">N &lt;-<span class="st"> </span><span class="kw">length</span>(n)</a>
<a class="sourceLine" id="cb93-56" title="56">power2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb93-57" title="57"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb93-58" title="58"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb93-59" title="59">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n[i],<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-60" title="60">e &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[i]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow=</span>n[i],<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-61" title="61">Y &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>X<span class="op">*</span>e</a>
<a class="sourceLine" id="cb93-62" title="62"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb93-63" title="63">p.ball[j] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(X,Y,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb93-64" title="64">}</a>
<a class="sourceLine" id="cb93-65" title="65">power2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.ball<span class="op">&lt;</span>.<span class="dv">05</span>)</a>
<a class="sourceLine" id="cb93-66" title="66">}</a>
<a class="sourceLine" id="cb93-67" title="67"><span class="kw">print</span>(<span class="kw">cbind</span>(n,power1,power2))</a></code></pre></div>
<pre><code>##         n power1 power2
##  [1,]  10    0.1      0
##  [2,]  20    0.1      1
##  [3,]  30    0.4      1
##  [4,]  40    0.5      1
##  [5,]  50    0.2      1
##  [6,]  60    0.7      1
##  [7,]  70    0.4      1
##  [8,]  80    0.9      1
##  [9,]  90    0.8      1
## [10,] 100    0.7      1
## [11,] 110    1.0      1
## [12,] 120    1.0      1
## [13,] 130    0.9      1
## [14,] 140    1.0      1
## [15,] 150    0.9      1</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">par</span>(<span class="dt">new=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">plot</span>(n, power2, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;DeepPink&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(n), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb95-3" title="3"><span class="kw">legend</span>(<span class="dv">120</span>,<span class="fl">0.3</span>,<span class="kw">c</span>(<span class="st">&quot;distance&quot;</span>,<span class="st">&quot;ball&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;DarkTurquoise&quot;</span>,<span class="st">&quot;DeepPink&quot;</span>),<span class="dt">text.col=</span><span class="kw">c</span>(<span class="st">&quot;DarkTurquoise&quot;</span>,<span class="st">&quot;DeepPink&quot;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">16</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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cGUtz1q+E2TX7tdOuP907VM2f1FoUa71gPKtoju1iu7hybFiAdLve12//qzvFd21vUZXF/Epu9N3vYtyrQfsilvk6leL2gs3Km4OEterINVc6vH3+VVFZXfZe3XHsijXdoApLAu8/ZsA5OGJQ3EB3YlzUGffeid29/of1ypfeZX9bJUDB+RfiFIyB3lYdygqIHl/UTf61qa/lk3h+fbSp6w6v6IcOEDDkE1LAvKw7lBMQDuToxGgV/mljQPI/GJRcoD0/WmPwNZpQaSIKE1MlUmxia3tXwhoTY3aZ+G/b1mvJG0Kr/PnYj4klqTNgw4enat+rGbnNSTY+XfzdrTcJdfNP74zz394DM/Wxn1cdhcwUKwBSmugmAe2dGeNB/g7My2BZfNzLsq1HlAD5OPJkThZBSIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiIKDUAT1d/+k66/ejcP2UPiD5xH6/n+7spfQBvTfPJJ5G6QP6UHk32OgiICACAiIgIAICIiCg1AGdXAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBPR/tHUfTh4leWEAAAAASUVORK5CYII=" /><!-- --></p>
<p>The blue line is for power1~n(distance covariance test),the pink line is for power2~n(ball covariance test).As shown above, we can see empirical power comparison of the distance covariance test dCov and ball covariance test for model 2.</p>
</div>
</div>
<div id="homework2019.11.29" class="section level2">
<h2>Homework(2019.11.29)</h2>
</div>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-9.4" class="section level2">
<h2>Answer 9.4</h2>
<p>The standard Lapace distribution density is <span class="math inline">\(f(x)=\frac{1}{2} e^{-|x|}, x \in \mathbb{R}.\)</span></p>
<p>In order to get the density and quantile of standard Lapace distribution,first install the package-“GeneralizedHyperbolic”.For example:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">library</span>(GeneralizedHyperbolic)</a>
<a class="sourceLine" id="cb96-2" title="2">dslap &lt;-<span class="st"> </span><span class="cf">function</span>(x){(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))}</a>
<a class="sourceLine" id="cb96-3" title="3">x &lt;-<span class="st"> </span><span class="kw">dskewlap</span>(<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb96-4" title="4">y &lt;-<span class="st"> </span><span class="kw">dslap</span>(<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb96-5" title="5"><span class="kw">print</span>(<span class="kw">c</span>(x,y))</a></code></pre></div>
<pre><code>## [1] 6.943972e-12 6.943972e-12</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">library</span>(GeneralizedHyperbolic) </a>
<a class="sourceLine" id="cb98-2" title="2">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>( sigma, x0, N) {</a>
<a class="sourceLine" id="cb98-3" title="3">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb98-4" title="4">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb98-5" title="5">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb98-6" title="6">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb98-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb98-8" title="8">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb98-9" title="9"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dskewlap</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dskewlap</span>(x[i<span class="dv">-1</span>]))) <span class="co">#dskewlap() can compute the density of                                                   Lapace distribution </span></a>
<a class="sourceLine" id="cb98-10" title="10">x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb98-11" title="11">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb98-12" title="12">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb98-13" title="13">}</a>
<a class="sourceLine" id="cb98-14" title="14">}</a>
<a class="sourceLine" id="cb98-15" title="15"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb98-16" title="16">} <span class="co">#generate the sample from standard Laplace distribution with rejected number  </span></a>
<a class="sourceLine" id="cb98-17" title="17"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb98-18" title="18">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb98-19" title="19">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb98-20" title="20">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb98-21" title="21">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb98-22" title="22">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb98-23" title="23">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb98-24" title="24">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb98-25" title="25">rej.num &lt;-<span class="st"> </span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb98-26" title="26">acce.rate &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb98-27" title="27"><span class="kw">print</span>(<span class="kw">cbind</span>(sigma,rej.num,acce.rate))</a></code></pre></div>
<pre><code>##      sigma rej.num acce.rate
## [1,]  0.05      32    0.9840
## [2,]  0.50     337    0.8315
## [3,]  2.00     944    0.5280
## [4,] 16.00    1810    0.0950</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">refline &lt;-<span class="st"> </span><span class="kw">qskewlap</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>)) <span class="co">#qskewlap() can compute the quantile of                                                   Lapace distribution</span></a>
<a class="sourceLine" id="cb100-2" title="2">rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb100-3" title="3"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb100-4" title="4"> <span class="kw">plot</span>((rw)[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb100-5" title="5"><span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb100-6" title="6"><span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb100-7" title="7"><span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb100-8" title="8">}</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZrY6kNtmAABmADpmZjpmZrZmtv+QOgCQ2/+2ZgC2Zma2///bkDrb2//b////tmb/25D//7b//9v///+afF6mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJQElEQVR4nO2d22LbKBRFaZt0LsnMNPXEU8fR///myEIgIQEbrANG9l4PTm2jA1mVuAkU1ZEo6tYFaB0KAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCJAj6Pz60r+elFJf30uVpzmyBR2//br860exEjVGrqBRzaDpIcgV9PE8CDo9zEXGMwiQJ6ivn9VTZ6rrhyCzme8dffnZN2QP44f9IAQFAa4UdGQrRjQUBKAgQJ6gQ1/1fDyrS1MfCLcbigga/Hz/uR6s5ud7a4oIGvrPh0tPOjjUeHRBP7rPt6ETHRqsPrag4ew53ugMEo5cRtD59ev7cAqdQrX0gwvS861Kj+glwmWwE0GVw01xpdvHOxMk34EoJOjYF1TPKNZtxfYi6NjXzefXSwVEQT50H+jzrW/i6woa/MiGLtZRvHD49qumILUbQWMv+tJhrCpI69mBIHthnV9DN58LCNL1zz4E9a2Yvsg+36oJsnMEuxBUO1xHQTjiXQgqNGE2VD6m9tm1oDLhhtbLRqSgdTDnnHxwQcpzLAW5B/oFbQ8dyk84YdlwTm0zfUhB9ji1crRsFinII6ijoPEAtdQxdoDUKqUQOxOkHEHmMwrqXEFmTGEFdRTUGSeuIOVt9bcX74pgjQgatQwnjTIzQFtjR/MVT5gfLmnoqsyVtBDkmSDzSRMpqEzC7HBpY3s1jthTBEnOKjYiCEdfCNJNFwU5qVxB+t++Y0WnmxqYMEubQJv6P3NBXhl7FuQLp5LOoXkqNUnwHegbz0oUVChhdrgkQWohyDrwHihYCRUS9Pmmr4LgOnsbztYlOPvFhen+XKRuXNDR7PIJbvfZLKiLCRI84YsIsreeE9YoToKiOawF2ePj8bdSRNBsdTRc5TpVtmr13Sx5WJC/CGLVdANn0PhDLT+ap3aG7ynlaluQvTWP6yA1VbZq+myVOiwoQOOCxl2rSgW39E5a7Cd2ZB4UlFGI1gWlhptXK1FBuYW4H0Gzj0wPeD3JoxY/E+LvRRBYYbYak5kPnZ72FZnvRhAI5/T81DTPsxyK5MeXMtSQIPNbqfmEjtokSMBSo4LUZkHd7QX9G9zwnfD8oIAgI2TqHq1upGYUWGJiKFPQ+R/z/uM5vCM+/PygxYSZp0F3Jzbc6y2LGwl6HTeAHWIPl0p4+ktcUCciKG0uF4bJS/j5dtkD9vEc3gnWJT0/KNTzWwm69gq7laBL1fLl7/B274HkM6iooOsPdQuUnVCfRDESnh8UETT8GC+s6+vo6TbINvIFHS9nEHxkCXp+EBBkvJQXhBLkCup/8afhdeOTk4KClu371XcBTacKpUIJkvMbXtNaseRwNxWk5tmhgibkN7ym9YPSt2TGBaktgjooSBUQNCfck96wJXM+r7hRUDSfroKgMBu2ZNYTpJT/xnVygGsTdpu2ZC4EbW+og4ffUtCWLZn2C2lByzjOoDDh+OSMUtiwJdMRlJ1xLN7iQzMoBvHLCNqwJXMmqBMWpJwPbytIIJxQhnFBOJ92BUlntLy5nXiGVha0mDCrwDjk3YugUuEiGZnuoCPImZKLH5+c0XXlqxQukpFHkDNTREEBQagkaSfYKr0UlQW5LbqzPejRBdlZk5CgUFEeSJAd85rfmYLcrNSiTzhvw8JFMbfukrO5uoA1wkWzoiCQlb6P1M2vGgqaZ6Xsi32fIij6bTC9FDUFDS9G0HqISkHDixW0Ggc+vKApP+XzsyjL1Nv2fAlzkONGgrwTCRRkM/XPtHgfbEFB87JQkMnVO1U3F7SaJqosqP6M4iJ776euIOWkfLQzyPspBdlcY4LUOA8y9bz1l6mxM8qRvgy4Mv5cRynO6r8KguJ/RrQpQcrcp1eqnqC0RZyVwYK6zsxgRw9Jju0nfRlwE6hxinEmyL2FlhYlI8dmzyA/xkhNQZe8UpYBN8FMkH07fZkcJS/TxGXATbAQ1KVM6XuiCBdKNtwmbKVsBeH5Rk8U4ULJhtvGNJlmPqgnqPIfHrmOWwqqFG477qwZBcWhIEAlQafYnxHND1eR8oIOSr18/PFrr39GtLigQz/AOAxnzx6GGmtKCxrOm+EP0e5isLqmvKBhM8t/Hc+gALZ7uIvBapRClfRRN18nFZhQfHhBtcOVg4IApS4xhfas7oYigvCe1bygielukuya5Al7VvOC3pughD2reUHvTVDCntW8oPcmKGHPal7QuxOE96zmBb0/QcJBKUgmHQW1mOzK5I8HBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAsgLii0fmq+1tuniB8T4+O1dOuQKcUGnyzrqcOn04pB5OnBAhPPrMK8pGXKNtCA9sX8IPrrbrJux6dABYU7jtizBkB6kBenNLuGbHsenRTp0QJCTetFq5EL6EBcUXV/V/7/+3tcXL7N06IAY+ijRkCukBelLP1gBnF8vK68OL1M6cEA8s4sD2ZArKgsaE319lxMkG3JF7UtMJ3r+IXiJiYZcUbuS1om+/xSpUeeChEKuqNzM67L3v5hImzwIkg25onZHcSh2X6OK9OrGVkwy5Ar5ocYx3s0/KLNIzaQDB0QYLzHJkCs4WAVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCADsQ5KzpNW+mtb+FaV+Qs1TDvrFrf0vTvCBnsc/0Rmj9GKZ5Qc5ysenNscLVNdCMoIN+MNTq6XrOgsPpjVn7W5xWBF0e8vnxp+cLZ8mqfWPX/hanEUHjqTFeN+PZpDeoeAXpdDUqokYE6V/1/Ne6aQpcYvq759DzHOVoS5DnL+IEKmn9XYW2vhFBWo05I+aXmL+Zt2t/i5esEUHD00+H5+utv/F2FO3a39K0Iqg/J5TyP2J4XNP7+fbUzRb42rW/hWlGUKtQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA/wHGNYW6TIEgFAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>As shown above,the function-rw.Metropolis can be used to generate the sample from standard Laplace distribution with rejected number.And when larger variances are used for the proposal distribution,the rejected numbers are larger and acceptance rates bacome lower.</p>
<p>And the figure shows Random walk Metropolis chains generated by proposal distributions with different variances.</p>
</div>
<div id="homework2019.12.06" class="section level2">
<h2>Homework(2019.12.06)</h2>
</div>
<div id="exercise-11.1" class="section level2">
<h2>Exercise 11.1</h2>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(logx) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
</div>
<div id="answer-11.1" class="section level2">
<h2>Answer 11.1</h2>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb101-2" title="2">y &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb101-3" title="3">z &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb101-4" title="4">y<span class="op">==</span>z</a></code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(y,z))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>AS shown above,we can see although logarithm and exponential functions are inverses of each other, the result does not hold in computer arithmetic.If use “all.equal”,the identity can hold.</p>
</div>
<div id="exercise-11.5" class="section level2">
<h2>Exercise 11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[
\begin{aligned} \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)}
\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u &amp; = \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \end{aligned}
\]</span> for a, where <span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span> Compare the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="answer-11.5" class="section level2">
<h2>Answer 11.5</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="co"># creat a function</span></a>
<a class="sourceLine" id="cb105-2" title="2">c.k&lt;-<span class="cf">function</span>(k,a){<span class="kw">return</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>(a<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))}</a>
<a class="sourceLine" id="cb105-3" title="3">f1&lt;-<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>(u<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb105-4" title="4">f2&lt;-<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>(u<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb105-5" title="5">f&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb105-6" title="6">(<span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f1,<span class="dv">0</span>,<span class="kw">c.k</span>(k<span class="dv">-1</span>,a))<span class="op">$</span>value<span class="dv">-2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f2,<span class="dv">0</span>,<span class="kw">c.k</span>(k,a))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb105-7" title="7">}  </a>
<a class="sourceLine" id="cb105-8" title="8"><span class="co"># compute roots</span></a>
<a class="sourceLine" id="cb105-9" title="9"><span class="kw">library</span>(rootSolve)</a>
<a class="sourceLine" id="cb105-10" title="10">t&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb105-11" title="11">n&lt;-<span class="kw">length</span>(t)</a>
<a class="sourceLine" id="cb105-12" title="12">root&lt;-root2&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb105-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb105-14" title="14">  k&lt;-t[i]</a>
<a class="sourceLine" id="cb105-15" title="15">  root[i]=<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.05</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb105-16" title="16">}</a>
<a class="sourceLine" id="cb105-17" title="17">f2&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb105-18" title="18">  <span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb105-19" title="19">}</a>
<a class="sourceLine" id="cb105-20" title="20">f<span class="fl">.4</span>&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb105-21" title="21">  <span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb105-22" title="22">}</a>
<a class="sourceLine" id="cb105-23" title="23">K1&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb105-24" title="24">n&lt;-<span class="kw">length</span>(K1)</a>
<a class="sourceLine" id="cb105-25" title="25">root<span class="fl">.4</span>&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb105-26" title="26"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb105-27" title="27">  k&lt;-K1[i]</a>
<a class="sourceLine" id="cb105-28" title="28">  root<span class="fl">.4</span>[i]&lt;-<span class="kw">uniroot</span>(f<span class="fl">.4</span>,<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb105-29" title="29">}</a>
<a class="sourceLine" id="cb105-30" title="30"><span class="kw">print</span>(<span class="kw">cbind</span>(t,root,root<span class="fl">.4</span>),) <span class="co">##the roots of 11.5 and 11.4</span></a></code></pre></div>
<pre><code>## Warning in cbind(t, root, root.4): number of rows of result is not a multiple of
## vector length (arg 1)</code></pre>
<pre><code>##         t     root    root.4
##  [1,]   4 1.492104  1.492105
##  [2,]   5 1.533559  1.533565
##  [3,]   6 1.562745  1.562774
##  [4,]   7 1.584428  1.584429
##  [5,]   8 1.601182  1.601210
##  [6,]   9 1.614529  1.614520
##  [7,]  10 1.625383  1.625383
##  [8,]  11 1.634409  1.634421
##  [9,]  12 1.642028  1.642056
## [10,]  13 1.648537  1.648526
## [11,]  14 1.654188  1.654168
## [12,]  15 1.659121  1.659095
## [13,]  16 1.663434  1.663433
## [14,]  17 1.667304  1.667281
## [15,]  18 1.670732  1.670725
## [16,]  19 1.673816  1.673824
## [17,]  20 1.676604  1.676639
## [18,]  21 1.679153  1.679154
## [19,]  22 1.681483  1.681472
## [20,]  23 1.683594  1.683596
## [21,]  24 1.685546  1.685550
## [22,]  25 1.687356  1.687355
## [23,] 100 1.720599  1.720600
## [24,]   4 1.492104 12.180340
## [25,]   5 1.533559 16.811388</code></pre>
<p>AS shown above,we can get the root and Compare the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<p>(1)Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</p>
<p>(2)Show that the log-maximum likelihood values in M-steps are increasing via line plot.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">N&lt;-<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="co"># max. number of the iteration</span></a>
<a class="sourceLine" id="cb108-3" title="3">n1&lt;-<span class="dv">28</span>;n2&lt;-<span class="dv">24</span>;n3&lt;-<span class="dv">41</span>;n4&lt;-<span class="dv">70</span></a>
<a class="sourceLine" id="cb108-4" title="4">L&lt;-<span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb108-5" title="5"><span class="co"># initial estimates </span></a>
<a class="sourceLine" id="cb108-6" title="6">tol&lt;-.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb108-7" title="7">L.old&lt;-L<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb108-8" title="8">E&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb108-9" title="9"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb108-10" title="10">  E[j]&lt;-<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>n1<span class="op">*</span><span class="kw">log</span>(L[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>n2<span class="op">*</span><span class="kw">log</span>(L[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>])<span class="op">+</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">+</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">+</span>n4<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>L[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb108-11" title="11">  model&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb108-12" title="12">    F1&lt;-<span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">*</span>n1<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">+</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">-</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n4<span class="op">/</span>x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb108-13" title="13">    F2&lt;-<span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">*</span>n2<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>n3<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">-</span>n1<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n2<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">-</span>x[<span class="dv">1</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>L[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>n4<span class="op">/</span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb108-14" title="14">    <span class="kw">c</span>(<span class="dt">F1=</span>F1,<span class="dt">F2=</span>F2)</a>
<a class="sourceLine" id="cb108-15" title="15">  }</a>
<a class="sourceLine" id="cb108-16" title="16">  ss&lt;-<span class="kw">multiroot</span>(<span class="dt">f=</span>model,<span class="dt">star=</span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb108-17" title="17">  L&lt;-ss<span class="op">$</span>root</a>
<a class="sourceLine" id="cb108-18" title="18">  <span class="co"># update p and q</span></a>
<a class="sourceLine" id="cb108-19" title="19">  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(L<span class="op">-</span>L.old)<span class="op">/</span>L.old)<span class="op">&lt;</span>tol) <span class="cf">break</span></a>
<a class="sourceLine" id="cb108-20" title="20">  L.old&lt;-L</a>
<a class="sourceLine" id="cb108-21" title="21">}</a>
<a class="sourceLine" id="cb108-22" title="22"><span class="kw">print</span>(L.old) <span class="co">#the estimator of p and q</span></a></code></pre></div>
<pre><code>## [1] 0.3273442 0.3104267</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">plot</span>(E,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Log-maximum likelihood values in M-steps&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As shown above,we can get the estimator of p and q.And log-maximum likelihood values in M-steps are increasing in the figure.</p>
</div>
<div id="homework2019.12.13" class="section level2">
<h2>Homework(2019.12.13)</h2>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise 3</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="part-1-with-a-for-loop" class="section level3">
<h3>Part 1 With a for loop</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">attach</span>(mtcars)</a>
<a class="sourceLine" id="cb111-2" title="2">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb111-3" title="3">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb111-4" title="4">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb111-5" title="5">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb111-6" title="6">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb111-7" title="7">)</a>
<a class="sourceLine" id="cb111-8" title="8">out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</a>
<a class="sourceLine" id="cb111-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</a>
<a class="sourceLine" id="cb111-10" title="10">out[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]])</a>
<a class="sourceLine" id="cb111-11" title="11">}</a>
<a class="sourceLine" id="cb111-12" title="12"><span class="kw">print</span>(out)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="part-2-with-lapply" class="section level3">
<h3>Part 2 With lapply</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">attach</span>(mtcars)</a></code></pre></div>
<pre><code>## The following objects are masked from mtcars (pos = 3):
## 
##     am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb115-2" title="2">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb115-3" title="3">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb115-4" title="4">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb115-5" title="5">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb115-6" title="6">)</a>
<a class="sourceLine" id="cb115-7" title="7"><span class="kw">lapply</span>(formulas,lm)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>As shown above,by using for loops and lapply(),the result are always the same.</p>
</div>
</div>
<div id="exercise-4" class="section level2">
<h2>Exercise 4</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="part-1-with-a-for-loop-1" class="section level3">
<h3>Part 1 With a for loop</h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb117-2" title="2">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb117-3" title="3">Mtc &lt;-mtcars[rows, ]</a>
<a class="sourceLine" id="cb117-4" title="4">Mtc<span class="op">$</span>mpg<span class="op">~</span>Mtc<span class="op">$</span>disp</a>
<a class="sourceLine" id="cb117-5" title="5">})</a>
<a class="sourceLine" id="cb117-6" title="6">out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(bootstraps))</a>
<a class="sourceLine" id="cb117-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)) {</a>
<a class="sourceLine" id="cb117-8" title="8">out[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(bootstraps[[i]])</a>
<a class="sourceLine" id="cb117-9" title="9">}</a>
<a class="sourceLine" id="cb117-10" title="10"><span class="kw">print</span>(out)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    26.71768     -0.03241  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    29.78674     -0.04157  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    29.39332     -0.03905  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    27.81021     -0.03279  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    31.14238     -0.04697  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    30.05310     -0.04754  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    31.19308     -0.04648  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    28.23353     -0.03622  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    26.73700     -0.03122  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    30.36659     -0.04073</code></pre>
</div>
<div id="part-2-with-lapply-1" class="section level3">
<h3>Part 2 with lapply</h3>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb119-2" title="2">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb119-3" title="3">Mtc &lt;-mtcars[rows, ]</a>
<a class="sourceLine" id="cb119-4" title="4"><span class="kw">lm</span> (Mtc<span class="op">$</span>mpg<span class="op">~</span>Mtc<span class="op">$</span>disp)</a>
<a class="sourceLine" id="cb119-5" title="5">})</a>
<a class="sourceLine" id="cb119-6" title="6"><span class="kw">print</span>(bootstraps )</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##     31.4479      -0.0482  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    29.61865     -0.04084  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    28.79733     -0.03656  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##     30.4324      -0.0422  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    28.26175     -0.03642  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    29.64161     -0.04224  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##     28.5549      -0.0386  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    29.79891     -0.05095  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    26.93021     -0.03245  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = Mtc$mpg ~ Mtc$disp)
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    29.31477     -0.04376</code></pre>
</div>
<div id="part-3-without-an-anonymous-function" class="section level3">
<h3>Part 3 without an anonymous function</h3>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">bootstraps &lt;-<span class="st"> </span>out &lt;-<span class="st">  </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb121-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(out)) {</a>
<a class="sourceLine" id="cb121-3" title="3"> rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb121-4" title="4"> Mtc &lt;-mtcars[rows, ]</a>
<a class="sourceLine" id="cb121-5" title="5"> bootstraps[[i]] &lt;-<span class="st"> </span>Mtc<span class="op">$</span>mpg<span class="op">~</span>Mtc<span class="op">$</span>disp</a>
<a class="sourceLine" id="cb121-6" title="6"> out[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(bootstraps[[i]])</a>
<a class="sourceLine" id="cb121-7" title="7">}</a>
<a class="sourceLine" id="cb121-8" title="8"><span class="kw">print</span>(out)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    31.20312     -0.04296  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    30.15281     -0.04287  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    28.64784     -0.04048  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    28.15345     -0.03618  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    30.67431     -0.04589  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    27.21631     -0.03426  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    28.60895     -0.03592  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##      28.769       -0.037  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    29.97540     -0.04261  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)     Mtc$disp  
##    30.53335     -0.04175</code></pre>
<p>As shown above,by using for loops,lapply(),and without an anonymous function,the result are always the same.</p>
</div>
</div>
<div id="exercise-5" class="section level2">
<h2>Exercise 5</h2>
<p>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="part-1-for-exercise-3" class="section level3">
<h3>Part 1 for Exercise 3</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">mod &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp)),</a>
<a class="sourceLine" id="cb123-4" title="4"><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt),</a>
<a class="sourceLine" id="cb123-5" title="5"><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb123-6" title="6">)</a>
<a class="sourceLine" id="cb123-7" title="7">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb123-8" title="8"><span class="kw">lapply</span>(mod,rsq) <span class="co"># extract R2 for model in Exercise 3</span></a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
</div>
<div id="part-2-for-exercise-4" class="section level3">
<h3>Part 2 for Exercise 4</h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb125-2" title="2">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb125-3" title="3">Mtc &lt;-mtcars[rows, ]</a>
<a class="sourceLine" id="cb125-4" title="4">L &lt;-<span class="st"> </span><span class="kw">lm</span> (Mtc<span class="op">$</span>mpg<span class="op">~</span>Mtc<span class="op">$</span>disp)</a>
<a class="sourceLine" id="cb125-5" title="5">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb125-6" title="6">bootstraps[i] &lt;-<span class="st"> </span><span class="kw">rsq</span>(L)</a>
<a class="sourceLine" id="cb125-7" title="7">})</a>
<a class="sourceLine" id="cb125-8" title="8"><span class="kw">print</span>(bootstraps) <span class="co"># extract R2 for model in Exercise 4</span></a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.419016
## 
## [[2]]
## [1] 0.6780979
## 
## [[3]]
## [1] 0.7049752
## 
## [[4]]
## [1] 0.6059496
## 
## [[5]]
## [1] 0.7141241
## 
## [[6]]
## [1] 0.8205101
## 
## [[7]]
## [1] 0.6864191
## 
## [[8]]
## [1] 0.6739601
## 
## [[9]]
## [1] 0.6570623
## 
## [[10]]
## [1] 0.8364257</code></pre>
</div>
</div>
<div id="exercise-3-1" class="section level2">
<h2>Exercise 3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE )</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">p.value &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb127-2" title="2">  p.value &lt;-<span class="st"> </span><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>))<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb127-3" title="3"> })</a>
<a class="sourceLine" id="cb127-4" title="4"><span class="kw">print</span>(p.value) <span class="co"># extract the p-value from every trial</span></a></code></pre></div>
<pre><code>##   [1] 0.713662192 0.798343609 0.971096485 0.646737839 0.563525959 0.621261588
##   [7] 0.316283518 0.777708652 0.761628570 0.004223613 0.247804480 0.253604242
##  [13] 0.573897784 0.894511911 0.285451324 0.529482928 0.098785236 0.922542545
##  [19] 0.091276154 0.904074271 0.658683043 0.923392384 0.399651988 0.623517508
##  [25] 0.197188774 0.367494577 0.122301178 0.683327456 0.814980448 0.159191065
##  [31] 0.273318421 0.289523702 0.423387112 0.208522312 0.723135465 0.397180437
##  [37] 0.049589098 0.151851960 0.968865381 0.985829339 0.732931667 0.964739547
##  [43] 0.584677676 0.870637797 0.664210254 0.686092767 0.474825336 0.153793071
##  [49] 0.823901041 0.877282563 0.581149447 0.427623007 0.338050891 0.471026129
##  [55] 0.784116017 0.149819171 0.642556602 0.680343689 0.137107295 0.232710134
##  [61] 0.444035632 0.720537441 0.268810273 0.519038873 0.772536402 0.665124187
##  [67] 0.118492429 0.400667394 0.485456634 0.612317607 0.919058789 0.316982656
##  [73] 0.482954771 0.131527652 0.017736074 0.313456285 0.263315333 0.636964793
##  [79] 0.453420317 0.813215883 0.975280305 0.332541473 0.606395162 0.615573488
##  [85] 0.537691810 0.483197995 0.515525323 0.346747992 0.422795723 0.933205531
##  [91] 0.614815645 0.977194787 0.073258277 0.634067356 0.834150127 0.179772799
##  [97] 0.791011338 0.636764234 0.270493338 0.835737156</code></pre>
</div>
<div id="exercise-7" class="section level2">
<h2>Exercise 7</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="part-1-implement-mcsapply" class="section level3">
<h3>Part 1 Implement mcsapply()</h3>
<ol style="list-style-type: decimal">
<li>Use parSapply()</li>
</ol>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, sqrt)</a></code></pre></div>
<pre><code>##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751 2.828427
##  [9] 3.000000 3.162278</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb131-2" title="2">cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(<span class="kw">getOption</span>(<span class="st">&quot;cl.cores&quot;</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb131-3" title="3"><span class="kw">parSapply</span>(cl,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, sqrt)</a></code></pre></div>
<pre><code>##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751 2.828427
##  [9] 3.000000 3.162278</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">fun &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb133-2" title="2">  <span class="kw">return</span>(x<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb133-3" title="3">}</a>
<a class="sourceLine" id="cb133-4" title="4"><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>, fun))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.01 0.00 0.01</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb135-2" title="2">cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(<span class="kw">getOption</span>(<span class="st">&quot;cl.cores&quot;</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb135-3" title="3"><span class="kw">system.time</span>(<span class="kw">parSapply</span>(cl,<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>, fun))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.03 0.08</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">stopCluster</span>(cl)</a></code></pre></div>
<p>As shown above,the results of using sapply() and parSapply() are the same,but the the advantage of parSapply is not clear,even the parSapply() takes more time.</p>
<ol start="2" style="list-style-type: decimal">
<li>Write a function-mcsapply()</li>
</ol>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1">mcsapply &lt;-<span class="st"> </span><span class="cf">function</span>(x, f, ...) {</a>
<a class="sourceLine" id="cb138-2" title="2">out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb138-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">sample</span>(<span class="kw">seq_along</span>(x))) {</a>
<a class="sourceLine" id="cb138-4" title="4">out[[i]] &lt;-<span class="st"> </span><span class="kw">f</span>(x[[i]], ...)</a>
<a class="sourceLine" id="cb138-5" title="5">}</a>
<a class="sourceLine" id="cb138-6" title="6">out</a>
<a class="sourceLine" id="cb138-7" title="7">}</a>
<a class="sourceLine" id="cb138-8" title="8"></a>
<a class="sourceLine" id="cb138-9" title="9">boot_df &lt;-<span class="st"> </span><span class="cf">function</span>(x) x[<span class="kw">sample</span>(<span class="kw">nrow</span>(x), <span class="dt">rep =</span> T), ]</a>
<a class="sourceLine" id="cb138-10" title="10">rsquared &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.square</a>
<a class="sourceLine" id="cb138-11" title="11">boot_lm &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb138-12" title="12"><span class="kw">rsquared</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>disp, <span class="dt">data =</span> <span class="kw">boot_df</span>(mtcars)))</a>
<a class="sourceLine" id="cb138-13" title="13">}</a>
<a class="sourceLine" id="cb138-14" title="14"><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, boot_lm))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.32 0.00 0.32</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, boot_lm))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.39 0.00 0.39</code></pre>
<p>As shown above, compare with sapply(),the system.time for mcsapply() is shorter, that means the compute process is quicker, although the advantage is not very clear.</p>
</div>
<div id="part-2-for-mcvapply" class="section level3">
<h3>Part 2 For mcvapply()</h3>
<p>I can not implement mcvapply(), a parallel version of vapply().The reasons are:<br />
(1) Compare with lapply() and sapply(),vapply() takes an additional argument specifying the output type.<br />
(2) If the function returns results of different types or lengths,vapply() will throw an error.<br />
(3) For lapply(),the order in which they are computed doesn??t matter,so it??s easy to dispatch the tasks to different cores,and compute them in parallel.But for vapply(),the things are different.</p>
</div>
</div>
<div id="homework2019.12.20" class="section level2">
<h2>Homework(2019.12.20)</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>(1)You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp functionfor the same task.<br />
(2) Compare the generated random numbers by the two functions using qqplot.<br />
(3) Campare the computation time of the two functions with microbenchmark.<br />
(4) Comments your results.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="part-1-5" class="section level3">
<h3>Part 1</h3>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb142-2" title="2">dir_cpp &lt;-<span class="st"> &#39;C:/Users/Administrator/Desktop/SC19052/src/&#39;</span></a>
<a class="sourceLine" id="cb142-3" title="3"><span class="co"># Can create source file in Rstudio</span></a>
<a class="sourceLine" id="cb142-4" title="4"><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;rwC.cpp&quot;</span>))</a></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;C:/
## Users/Administrator/Desktop/SC19052/src/../inst/include&quot;: 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb144-2" title="2">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb144-3" title="3">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb144-4" title="4">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb144-5" title="5">rw1 &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb144-6" title="6">rw2 &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb144-7" title="7">rw3 &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb144-8" title="8">rw4 &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb144-9" title="9">rej.num &lt;-<span class="st"> </span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb144-10" title="10">acce.rate &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb144-11" title="11"><span class="kw">print</span>(<span class="kw">cbind</span>(sigma,rej.num,acce.rate))</a></code></pre></div>
<pre><code>##      sigma rej.num acce.rate
## [1,]  0.05      32    0.9840
## [2,]  0.50     255    0.8725
## [3,]  2.00     890    0.5550
## [4,] 16.00    1792    0.1040</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="kw">library</span>(GeneralizedHyperbolic) </a>
<a class="sourceLine" id="cb146-2" title="2">refline &lt;-<span class="st"> </span><span class="kw">qskewlap</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>)) </a>
<a class="sourceLine" id="cb146-3" title="3">rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb146-4" title="4"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb146-5" title="5"> <span class="kw">plot</span>((rw)[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb146-6" title="6"><span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb146-7" title="7"><span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb146-8" title="8"><span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb146-9" title="9">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>As shown above,the cpp function-“rwC” can be used to generate the sample from standard Laplace distribution with rejected number.And when larger variances are used for the proposal distribution,the rejected numbers are larger and acceptance rates bacome lower.<br />
And the figure shows Random walk Metropolis chains generated by proposal distributions with different variances.</p>
</div>
<div id="part-2-5" class="section level3">
<h3>Part 2</h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="kw">library</span>(GeneralizedHyperbolic) </a>
<a class="sourceLine" id="cb147-2" title="2">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>( sigma, x0, N) {</a>
<a class="sourceLine" id="cb147-3" title="3">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb147-4" title="4">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb147-5" title="5">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb147-6" title="6">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb147-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb147-8" title="8">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb147-9" title="9"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dskewlap</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dskewlap</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb147-10" title="10">x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb147-11" title="11">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb147-12" title="12">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb147-13" title="13">}</a>
<a class="sourceLine" id="cb147-14" title="14">}</a>
<a class="sourceLine" id="cb147-15" title="15"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb147-16" title="16">}</a>
<a class="sourceLine" id="cb147-17" title="17"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb147-18" title="18">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb147-19" title="19">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb147-20" title="20">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb147-21" title="21">rwR1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb147-22" title="22">rwR2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb147-23" title="23">rwR3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb147-24" title="24">rwR4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb147-25" title="25">rwR &lt;-<span class="st"> </span><span class="kw">cbind</span>(rwR1<span class="op">$</span>x, rwR2<span class="op">$</span>x, rwR3<span class="op">$</span>x, rwR4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb147-26" title="26"></a>
<a class="sourceLine" id="cb147-27" title="27"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb147-28" title="28">dir_cpp &lt;-<span class="st"> &#39;C:/Users/Administrator/Desktop/SC19052/src/&#39;</span></a>
<a class="sourceLine" id="cb147-29" title="29"><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;rwC.cpp&quot;</span>))</a>
<a class="sourceLine" id="cb147-30" title="30">rwC1 &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb147-31" title="31">rwC2 &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb147-32" title="32">rwC3 &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb147-33" title="33">rwC4 &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb147-34" title="34">rwC &lt;-<span class="st"> </span><span class="kw">cbind</span>(rwC1<span class="op">$</span>x, rwC2<span class="op">$</span>x, rwC3<span class="op">$</span>x, rwC4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb147-35" title="35"></a>
<a class="sourceLine" id="cb147-36" title="36"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb147-37" title="37">  <span class="kw">qqplot</span>(rwR[,j],rwC[,j],<span class="dt">xlab=</span><span class="st">&#39;rwR&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;rwC&#39;</span>)</a>
<a class="sourceLine" id="cb147-38" title="38">  <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb147-39" title="39">  }</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>AS shown above,we can see the qqplot of the generated random numbers by the two functions.</p>
</div>
<div id="part-3-1" class="section level3">
<h3>Part 3</h3>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb148-2" title="2">dir_cpp &lt;-<span class="st"> &#39;C:/Users/Administrator/Desktop/SC19052/src/&#39;</span></a>
<a class="sourceLine" id="cb148-3" title="3"><span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;rwC.cpp&quot;</span>))</a>
<a class="sourceLine" id="cb148-4" title="4"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb148-5" title="5">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb148-6" title="6">sigma &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb148-7" title="7">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb148-8" title="8">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">R=</span><span class="kw">rw.Metropolis</span>(sigma,x0,N),<span class="dt">cpp=</span><span class="kw">rwC</span>(sigma,x0,N))</a>
<a class="sourceLine" id="cb148-9" title="9"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr        lq    median       uq
## 1    R 31795.929 33030.982 34817.17
## 2  cpp   592.165   667.397   686.49</code></pre>
<p>AS shown above,compare with R function,the computation time for Rcpp function is shorter, that means the compute process is quicker.</p>
</div>
<div id="part-4" class="section level3">
<h3>Part 4</h3>
<p>Comments the results:<br />
(1) For Part 1,the results of R function and Rcpp function are similar.But, compare the acceptance rates of two functions,the acceptance rate is a little higher by using Rcpp function.<br />
(2) For Part 2,from the qqplot of the generated random numbers by the two functions,we can see these points are not exactly but approximately on the reference line.That means there are some differences between the two functions,especially when variance is small.<br />
(3) For Part 3,compare with R function,the computation time for Rcpp function is shorter, that means the compute process is quicker.<br />
There are simliarities and differents between R function and Rcpp function.In conclusion,the effect of Rcpp is better.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
